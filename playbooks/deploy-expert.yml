---
- name: deploy-expert
  hosts: all
  vars:
    source_folder: "../3-expert/"
    destination_folder: "~/3-expert"

  tasks:
  - name: copy-intermediate-folder-contents
    ansible.builtin.copy:
      src: "{{ source_folder }}"
      dest: "{{ destination_folder }}/"
    register: task_result

  - name: check-if-docker-compose-is-valid
    ansible.builtin.command:
      cmd: docker compose config
      chdir: "{{ destination_folder }}"
    register: compose_check
    changed_when: false
    when: task_result.changed
